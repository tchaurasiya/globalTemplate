template:
  inputs:
    tech_stack:
      type: string
      label: Tech stack language change for 1 update with a fial file more update 3
      
      default: java
      options:
        - java
        - go
        - dotnet
        - python
      ui:
        component: select
        tooltip: Select the language of your infrastructure code repository
    connector:
      type: connector
      label: AWS connector
      
      oneof:
        - Aws
      ui:
        tooltip: Select the Harness AWS connector for the AWS account where you want to perform deployment
        placeholder: Select AWS connector
    region:
      type: string
      label: Region
      
      ui:
        component: string
        placeholder: us-east-1
        tooltip: Specify the AWS region for deployment
    log_level:
      type: string
      label: Log level
      default: error
      options:
        - info
        - warn
        - error
        - debug
        - trace
      ui:
        component: select
        tooltip: Select the log level for the build step
    bootstrap:
      type: boolean
      label: Execute bootstrap
      default: false
      ui:
        component: boolean-card-select
        tooltip: Enable to execute the bootstrap action
    diff:
      type: boolean
      label: Execute diff
      default: false
      ui:
        component: boolean-card-select
        tooltip: Enable to execute the diff action
    synth:
      type: boolean
      label: Execute synth
      default: false
      ui:
        component: boolean-card-select
        tooltip: Enable to execute the synth action (this will prevent the deploy action from executing)
    app_params:
      type: array
      label: App parameters
      ui:
        component: array
        input:
          inputType: text
        tooltip: Enter the CDK app parameters
        placeholder: Enter CDK app parameters
    stacks:
      type: array
      label: Stack names
      ui:
        component: array
        input:
          inputType: text
        tooltip: Enter the CDK stack names
        placeholder: Enter CDK stack names
    work_dir:
      type: string
      label: Working directory
      ui:
        component: string
        tooltip: Specify the AWS CDK working directory
        placeholder: /
    app_path:
      type: string
      label: App path
      
      ui:
        component: string
        tooltip: Enter the CDK app path (this will be appended to PLUGIN_WORK_DIR)
        placeholder: Enter CDK app path (this will be appended to PLUGIN_WORK_DIR)
    cmd_opts:
      type: string
      label: Command options
      ui:
        component: string
        input:
          inputType: text
        tooltip: Enter additional command options for the CDK deploy command
        placeholder: Enter CDK deploy command options
  layout:
    - tech_stack
    - connector
    - region
    - app_path
    - title: Optional Configuration
      items:
        - cmd_opts
        - work_dir
        - stacks
        - app_params
        - log_level
        - bootstrap
        - diff
        - synth
  id: awsCdkDeployStep
  name: AWS CDK Deploy Step
  description: Creates infrastructure in AWS
  version: 1
  author: harness
  module:
    - cd
  alias: deploy
  step:
    group:
      steps:
        - name: Deploy
          id: deploy
          run:
            container:
              image: harnessdev/aws-cdk:0.0.1-${{inputs.tech_stack}}
              connector: account.harnessImage
            env:
              PLUGIN_ACTION: deploy
              PLUGIN_CMD_OPTS: ${{inputs.cmd_opts}}
              PLUGIN_APP_PATH: ${{inputs.app_path}}
              PLUGIN_WORK_DIR: ${{inputs.work_dir}}
              PLUGIN_STACKS: ${{inputs.stacks}}
              PLUGIN_APP_PARAMS: ${{inputs.app_params}}
              PLUGIN_EXECUTE_BOOTSTRAP: ${{inputs.bootstrap}}
              PLUGIN_EXECUTE_DIFF: ${{inputs.diff}}
              PLUGIN_EXECUTE_SYNTH: ${{inputs.synth}}
              PLUGIN_LOG_LEVEL: ${{inputs.log_level}}
              PLUGIN_REGION: ${{inputs.region}}
              PLUGIN_HARNESS_CONNECTOR: ${{inputs.connector.id}}
