template:
  id: remotedockerbuildpush
  name: remotedockerbuildpush
  version: 1.0
  inputs:
    connector:
      type: connector
    dockerfile:
      type: string
    context:
      type: string
    tags:
      type: string
    buildArgs:
      type: string
    target:
      type: string
    repo:
      type: string
    labels:
      type: string
  step:
    group:
      steps:
        - run:
            container:
              image: alpine
            script: "echo \"from alpine\" > testfile"
        - run:
            container:
              image: plugins/docker
            with:
              USERNAME: <+inputs.connector.username>
              PASSWORD: <+inputs.connector.password>
              REGISTRY: <+inputs.connector.url>
              DOCKERFILE: <+inputs.dockerfile>
              CONTEXT: <+inputs.context>
              TAGS: <+inputs.tags>
              BUILD_ARGS: <+inputs.buildArgs>
              TARGET: <+inputs.target>
              REPO: <+inputs.repo>
              CUSTOM_LABELS: <+inputs.labels>
              BASE_IMAGE_REGISTRY: <+runtime.baseImageRegistry>
              CACHE_TO: <+inputs.cacheTo>
              BUILDER_DRIVER_OPTS: <+runtime.builderDriverOpts>
              CACHE_METRICS_FILE: <+runtime.cacheMetricsFile>
              CACHE_FROM: <+runtime.cacheFrom>
              METADATA_FILE: <+runtime.metadataFile>
              SNAPSHOT_MODE: <+runtime.snapshotMode>
              ENABLE_CACHE: <+runtime.enableCache>
              CACHE_REPO: <+runtime.cacheRepo>
              ARTIFACT_FILE: <+runtime.artifactFile>
              DAEMON_OFF: true